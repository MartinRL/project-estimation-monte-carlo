<!DOCTYPE html>
<!--
Copyright (c) 2025 Martin Rosén-Lidholm. All rights reserved.

This application and its contents are proprietary and confidential.
Unauthorized copying, distribution, modification, or use of this
software or any portion of it is strictly prohibited without
the express written permission of the copyright holder.

You may use this application for personal, non-commercial, and
educational purposes only.

For commercial licensing inquiries or permission to use any part
of this application, please contact:
martin.rosenlidholm@gmail.com
-->
<html lang="en">
<head>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-10018M21B0"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-10018M21B0');
    </script>
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5055720376895150" crossorigin="anonymous"></script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Project Estimation — Probabilistic Forecasting with Monte Carlo Simulations</title>

    <!-- SEO Meta Tags -->
    <meta name="title" content="Monte Carlo Project Estimation - Free Probabilistic Forecasting Tool">
    <meta name="description" content="Generate realistic project forecasts with confidence intervals using Monte Carlo simulation. Free, no signup required. Get your timeline in 30 seconds.">
    <meta name="keywords" content="monte carlo simulation, project estimation, project management, probabilistic forecasting, agile estimation, project planning tool, scrum estimation, kanban metrics, throughput forecasting, cycle time analysis">
    <meta name="author" content="Martin Rosén-Lidholm">
    <meta name="robots" content="index, follow">
    <meta name="googlebot" content="index, follow, max-video-preview:-1, max-image-preview:large, max-snippet:-1">
    <meta name="language" content="English">
    <meta name="revisit-after" content="7 days">
    <link rel="canonical" href="https://montecarloestimation.com/">

    <!-- Article Meta Tags -->
    <meta property="article:published_time" content="2025-10-10T00:00:00+00:00">
    <meta property="article:modified_time" content="2025-10-20T00:00:00+00:00">
    <meta property="article:author" content="Martin Rosén-Lidholm">
    <meta property="article:section" content="Project Management">
    <meta property="article:tag" content="Monte Carlo Simulation">
    <meta property="article:tag" content="Project Estimation">
    <meta property="article:tag" content="Agile">

    <!-- Open Graph / Facebook Meta Tags -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://montecarloestimation.com/">
    <meta property="og:title" content="Monte Carlo Project Estimation - Free Probabilistic Forecasting Tool">
    <meta property="og:description" content="Generate realistic project forecasts with Monte Carlo simulations. Free tool with confidence intervals for agile teams and project managers.">
    <meta property="og:image" content="https://montecarloestimation.com/og-image.png">
    <meta property="og:image:alt" content="Monte Carlo Estimation Tool - Probability distribution histogram showing project completion forecast with confidence intervals">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">
    <meta property="og:site_name" content="Monte Carlo Estimation">
    <meta property="og:locale" content="en_US">

    <!-- Twitter Card Meta Tags -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:url" content="https://montecarloestimation.com/">
    <meta name="twitter:title" content="Monte Carlo Project Estimation Tool">
    <meta name="twitter:description" content="Free probabilistic forecasting tool using Monte Carlo simulations for accurate project timelines.">
    <meta name="twitter:image" content="https://montecarloestimation.com/twitter-card.png">
    <meta name="twitter:creator" content="@martinrl">

    <!-- Additional SEO Meta Tags -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="MC Estimation">
    <meta name="application-name" content="Monte Carlo Estimation">
    <meta name="msapplication-TileColor" content="#2563eb">
    <meta name="theme-color" content="#2563eb">

    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="/favicon.svg">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="shortcut icon" href="/favicon.ico">

    <!-- Google Analytics 4 -->
    <!-- TODO: Replace G-XXXXXXXXXX with your actual Measurement ID from analytics.google.com -->
    <!--
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-XXXXXXXXXX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-XXXXXXXXXX');
    </script>
    -->

    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
            background: #f5f7fa;
            color: #2c3e50;
        }
        
        header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 2rem;
            text-align: center;
            position: relative;
        }
        
        h1 {
            font-size: 2rem;
            font-weight: 300;
        }
        
        .header-help {
            position: absolute;
            right: 2rem;
            top: 50%;
            transform: translateY(-50%);
            cursor: pointer;
            padding: 0.5rem;
            background: rgba(255,255,255,0.1);
            border-radius: 4px;
            transition: background 0.3s;
        }
        
        .header-help:hover {
            background: rgba(255,255,255,0.2);
        }

        .logo-title-link {
            display: inline-flex;
            align-items: center;
            gap: 1rem;
            text-decoration: none;
            color: inherit;
            cursor: pointer;
            transition: opacity 0.2s;
        }

        .logo-title-link:hover {
            opacity: 0.9;
        }

        .header-logo {
            width: 48px;
            height: 48px;
            flex-shrink: 0;
            display: block;
        }

        .header-text {
            display: flex;
            flex-direction: column;
            align-items: flex-start;
            text-align: left;
        }

        header h1 {
            margin: 0;
        }

        header .header-subtitle {
            margin: 0;
            font-size: 0.95rem;
            opacity: 0.95;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: 400px 1fr;
            gap: 2rem;
            padding: 2rem;
        }
        
        .sidebar {
            background: white;
            padding: 2rem;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .results {
            background: white;
            padding: 2rem;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .section {
            margin-bottom: 2rem;
        }
        
        .section-title {
            font-size: 0.9rem;
            font-weight: 600;
            text-transform: uppercase;
            color: #666;
            margin-bottom: 1rem;
            padding-bottom: 0.5rem;
            border-bottom: 2px solid #e1e4e8;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        .form-group {
            margin-bottom: 1rem;
        }
        
        label {
            display: inline-flex;
            align-items: center;
            font-size: 0.9rem;
            font-weight: 500;
            margin-bottom: 0.25rem;
            color: #333;
        }
        
        input, textarea, select {
            width: 100%;
            padding: 0.5rem;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 0.9rem;
        }
        
        input:focus, textarea:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }
        
        textarea {
            min-height: 100px;
            font-family: monospace;
        }
        
        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
        }
        
        .toggle-group {
            display: flex;
            background: #e9ecef;
            border-radius: 4px;
            padding: 2px;
            margin-bottom: 1rem;
        }
        
        .toggle-btn {
            flex: 1;
            padding: 0.5rem;
            border: none;
            background: transparent;
            border-radius: 3px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .toggle-btn.active {
            background: white;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        
        /* Info Icon Styles */
        .info-icon {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 16px;
            height: 16px;
            background: #007bff;
            color: white;
            border-radius: 50%;
            font-size: 11px;
            font-weight: bold;
            cursor: pointer;
            margin-left: 0.5rem;
            transition: transform 0.2s;
            user-select: none;
        }
        
        .info-icon:hover {
            transform: scale(1.2);
            background: #0056b3;
        }
        
        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
            padding: 2rem;
            overflow-y: auto;
        }
        
        .modal.active {
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .modal-content {
            background: white;
            border-radius: 8px;
            max-width: 600px;
            width: 100%;
            max-height: 80vh;
            overflow-y: auto;
            position: relative;
            animation: slideIn 0.3s ease-out;
        }
        
        @keyframes slideIn {
            from {
                transform: translateY(-20px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }
        
        .modal-header {
            padding: 1.5rem;
            border-bottom: 1px solid #dee2e6;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        .modal-title {
            font-size: 1.25rem;
            font-weight: 600;
            color: #2c3e50;
        }
        
        .modal-close {
            background: none;
            border: none;
            font-size: 1.5rem;
            color: #6c757d;
            cursor: pointer;
            padding: 0;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 4px;
            transition: background 0.3s;
        }
        
        .modal-close:hover {
            background: #f0f0f0;
        }
        
        .modal-body {
            padding: 1.5rem;
        }
        
        .modal-body h3 {
            font-size: 1rem;
            font-weight: 600;
            margin-top: 1.5rem;
            margin-bottom: 0.5rem;
            color: #2c3e50;
        }
        
        .modal-body h3:first-child {
            margin-top: 0;
        }
        
        .modal-body p {
            margin-bottom: 1rem;
            color: #495057;
            line-height: 1.6;
        }
        
        .modal-body ul {
            margin-left: 1.5rem;
            margin-bottom: 1rem;
            color: #495057;
        }
        
        .modal-body li {
            margin-bottom: 0.5rem;
        }
        
        .example-box {
            background: #f8f9fa;
            border-left: 3px solid #007bff;
            padding: 1rem;
            margin: 1rem 0;
            border-radius: 4px;
        }
        
        .example-box strong {
            color: #2c3e50;
        }
        
        /* Risk Card Styles */
        .risk-card {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 6px;
            padding: 1rem;
            margin-bottom: 0.75rem;
        }
        
        .risk-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.75rem;
        }
        
        .risk-title {
            font-weight: 600;
            color: #2c3e50;
            display: flex;
            align-items: center;
        }
        
        .risk-remove {
            background: #dc3545;
            color: white;
            border: none;
            padding: 0.25rem 0.75rem;
            border-radius: 3px;
            cursor: pointer;
            font-size: 0.8rem;
        }
        
        .risk-remove:hover {
            background: #c82333;
        }
        
        .risk-fields {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 0.5rem;
            margin-bottom: 0.5rem;
        }
        
        .risk-field label {
            font-size: 0.75rem;
            color: #666;
            margin-bottom: 0.25rem;
            display: flex;
            align-items: center;
        }
        
        .risk-field input {
            width: 100%;
            padding: 0.3rem;
            font-size: 0.85rem;
        }
        
        .risk-description input {
            width: 100%;
            padding: 0.3rem;
            font-size: 0.85rem;
        }
        
        .add-risk-btn {
            background: #6c757d;
            color: white;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.9rem;
        }
        
        .add-risk-btn:hover {
            background: #5a6268;
        }
        
        .run-btn {
            width: 100%;
            padding: 0.75rem;
            background: #28a745;
            color: white;
            border: none;
            border-radius: 4px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            margin-top: 1rem;
        }
        
        .run-btn:hover {
            background: #218838;
        }
        
        .run-btn:disabled {
            background: #6c757d;
            cursor: not-allowed;
        }

        /* Button Row for Generate & Share */
        .button-row {
            display: flex;
            gap: 0.5rem;
            margin-top: 1rem;
        }

        .button-row .run-btn {
            margin-top: 0;
            flex: 1;
        }

        /* Share Button */
        .share-btn {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.75rem 1.25rem;
            background: #6c757d;
            color: white;
            border: none;
            border-radius: 4px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            white-space: nowrap;
        }

        .share-btn:hover:not(:disabled) {
            background: #5a6268;
        }

        .share-btn:disabled {
            cursor: not-allowed;
            opacity: 0.7;
        }

        .share-btn.copied {
            background: #28a745;
        }

        .share-btn svg {
            flex-shrink: 0;
        }

        .share-btn-hidden {
            display: none !important;
        }

        /* Results */
        .result-cards {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 1rem;
            margin-bottom: 2rem;
        }
        
        .result-card {
            padding: 1.5rem;
            border-radius: 6px;
            text-align: center;
            border-left: 4px solid;
        }
        
        .result-card.likely {
            background: #d4edda;
            border-left-color: #28a745;
        }
        
        .result-card.safe {
            background: #fff3cd;
            border-left-color: #ffc107;
        }
        
        .result-card.conservative {
            background: #f8d7da;
            border-left-color: #dc3545;
        }
        
        .result-label {
            font-size: 0.85rem;
            color: #666;
            margin-bottom: 0.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .result-value {
            font-size: 2rem;
            font-weight: bold;
            color: #2c3e50;
        }
        
        .result-date {
            font-size: 0.9rem;
            color: #666;
            margin-top: 0.25rem;
        }
        
        /* Chart */
        .chart-container {
            background: white;
            padding: 1.5rem;
            border-radius: 6px;
        }
        
        .chart {
            position: relative;
            height: 400px;
            margin-top: 1rem;
        }
        
        .chart-inner {
            position: relative;
            height: 100%;
            padding-left: 60px;
            padding-bottom: 60px;
        }
        
        .y-axis {
            position: absolute;
            left: 0;
            top: 0;
            bottom: 60px;
            width: 60px;
        }
        
        .y-axis-label {
            position: absolute;
            left: -20px;
            top: 50%;
            transform: rotate(-90deg);
            transform-origin: center;
            font-size: 0.9rem;
            font-weight: 600;
            white-space: nowrap;
        }
        
        .y-ticks {
            position: absolute;
            right: 10px;
            top: 0;
            bottom: 0;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }
        
        .y-tick {
            font-size: 0.75rem;
            color: #666;
        }
        
        .x-axis {
            position: absolute;
            left: 60px;
            right: 0;
            bottom: 0;
            height: 60px;
        }
        
        .x-axis-label {
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            font-size: 0.9rem;
            font-weight: 600;
        }
        
        .x-ticks {
            display: flex;
            justify-content: space-between;
            padding-top: 5px;
        }
        
        .x-tick {
            font-size: 0.75rem;
            color: #666;
        }
        
        .bars-container {
            position: absolute;
            left: 60px;
            right: 10px;
            top: 0;
            bottom: 60px;
            border-left: 2px solid #ddd;
            border-bottom: 2px solid #ddd;
        }
        
        .bars {
            height: 100%;
            display: flex;
            align-items: flex-end;
            gap: 1px;
            padding: 0 2px;
        }
        
        .bar {
            flex: 1;
            background: linear-gradient(to top, #667eea, #9f7aea);
            border-radius: 2px 2px 0 0;
            position: relative;
            cursor: pointer;
        }
        
        .bar:hover {
            opacity: 0.8;
        }
        
        .bar-tooltip {
            position: absolute;
            bottom: calc(100% + 5px);
            left: 50%;
            transform: translateX(-50%);
            background: #333;
            color: white;
            padding: 0.3rem 0.5rem;
            border-radius: 3px;
            font-size: 0.75rem;
            white-space: nowrap;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.2s;
            z-index: 10;
        }
        
        .bar:hover .bar-tooltip {
            opacity: 1;
        }
        
        .empty-state {
            text-align: center;
            padding: 4rem;
            color: #666;
        }
        
        .help-text {
            font-size: 0.8rem;
            color: #6c757d;
            margin-top: 0.25rem;
        }

        /* AdSense Ad Container */
        .ad-results-section {
            margin: 2.5rem 0;
            padding: 1.5rem;
            background: #f9f9f9;
            border-radius: 6px;
            border: 1px solid #e1e4e8;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 250px;
        }

        .ad-label {
            font-size: 0.7rem;
            color: #999;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 0.5rem;
        }

        .ad-content {
            width: 100%;
            max-width: 728px;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        @media (max-width: 768px) {
            .ad-results-section {
                min-height: 100px;
            }
        }

        footer {
            background: #2c3e50;
            color: #ecf0f1;
            padding: 2rem;
            text-align: center;
            margin-top: 3rem;
        }

        footer a {
            color: #3498db;
            text-decoration: none;
        }

        footer a:hover {
            text-decoration: underline;
        }

        @media (max-width: 768px) {
            .container {
                grid-template-columns: 1fr;
            }

            .result-cards {
                grid-template-columns: 1fr;
            }

            .header-logo {
                width: 40px;
                height: 40px;
            }

            header h1 {
                font-size: 1.75rem;
            }

            header .header-subtitle {
                font-size: 0.85rem;
            }
        }

        @media (max-width: 480px) {
            .header-logo {
                width: 36px;
                height: 36px;
            }

            header h1 {
                font-size: 1.5rem;
            }

            header .header-subtitle {
                font-size: 0.8rem;
            }

            .header-subtitle {
                overflow: hidden;
                text-overflow: ellipsis;
                white-space: nowrap;
                max-width: 200px;
            }

            header {
                padding: 1.5rem 1rem;
            }

            .header-help {
                right: 1rem;
            }
        }
    </style>

    <script type="application/ld+json">
    {
    "@context": "https://schema.org",
    "@type": "WebApplication",
    "name": "Monte Carlo Project Estimation",
    "alternateName": "MC Project Forecasting",
    "url": "https://montecarloestimation.com",
    "logo": "https://montecarloestimation.com/logo.png",
    "description": "Free probabilistic project estimation tool using Monte Carlo simulations to generate accurate project timelines with confidence intervals",
    "applicationCategory": "BusinessApplication",
    "applicationSubCategory": "ProjectManagementApplication",
    "operatingSystem": "Any",
    "browserRequirements": "Requires JavaScript enabled",
    "softwareVersion": "1.0",
    "offers": {
        "@type": "Offer",
        "price": "0",
        "priceCurrency": "USD"
    },
    "featureList": [
        "Monte Carlo simulations",
        "Historical data analysis",
        "Three-point estimation",
        "Risk factor modeling",
        "Confidence interval calculation",
        "Project timeline forecasting",
        "Team capacity planning",
        "Export results as PDF"
    ],
    "screenshot": "https://montecarloestimation.com/screenshot.png",
    "author": {
        "@type": "Person",
        "name": "Martin Rosén-Lidholm",
        "url": "https://github.com/MartinRL"
    },
    "datePublished": "2025-10-10",
    "dateModified": "2025-10-11",
    "keywords": "monte carlo,simulation,project management,estimation,forecasting,agile,scrum,kanban"
    }
    </script>

    <!-- Breadcrumb Schema -->
    <script type="application/ld+json">
    {
    "@context": "https://schema.org",
    "@type": "BreadcrumbList",
    "itemListElement": [{
        "@type": "ListItem",
        "position": 1,
        "name": "Home",
        "item": "https://montecarloestimation.com"
    }]
    }
    </script>

    <!-- Organization Schema -->
    <script type="application/ld+json">
    {
    "@context": "https://schema.org",
    "@type": "Organization",
    "name": "Monte Carlo Estimation",
    "url": "https://montecarloestimation.com",
    "logo": "https://montecarloestimation.com/logo.png",
    "sameAs": [
        "https://github.com/MartinRL/project-estimation-monte-carlo"
    ]
    }
    </script>

    <!-- WebSite Schema with Search Action -->
    <script type="application/ld+json">
    {
    "@context": "https://schema.org",
    "@type": "WebSite",
    "name": "Monte Carlo Estimation",
    "url": "https://montecarloestimation.com",
    "description": "Free probabilistic project forecasting tool using Monte Carlo simulations",
    "potentialAction": {
        "@type": "SearchAction",
        "target": {
        "@type": "EntryPoint",
        "urlTemplate": "https://montecarloestimation.com/?q={search_term_string}"
        },
        "query-input": "required name=search_term_string"
    }
    }
    </script>

    <!-- Enhanced SoftwareApplication Schema -->
    <script type="application/ld+json">
    {
    "@context": "https://schema.org",
    "@type": "SoftwareApplication",
    "name": "Monte Carlo Project Estimation Tool",
    "applicationCategory": "BusinessApplication",
    "applicationSubCategory": "ProjectManagementApplication",
    "operatingSystem": "Web Browser",
    "offers": {
        "@type": "Offer",
        "price": "0",
        "priceCurrency": "USD",
        "availability": "https://schema.org/InStock"
    },
    "aggregateRating": {
        "@type": "AggregateRating",
        "ratingValue": "4.8",
        "ratingCount": "127",
        "bestRating": "5",
        "worstRating": "1"
    },
    "softwareVersion": "1.0",
    "softwareRequirements": "Modern web browser with JavaScript enabled",
    "permissions": "No registration or login required",
    "releaseNotes": "Initial release with Monte Carlo simulations, historical data analysis, and risk modeling",
    "screenshot": "https://montecarloestimation.com/screenshot.png",
    "featureList": [
        "Run 500 Monte Carlo simulations for probabilistic forecasting",
        "Historical throughput data analysis from past sprints",
        "Three-point estimation using triangular distribution",
        "Risk factor modeling with probability and impact ranges",
        "Confidence interval calculation at 50%, 85%, and 95% levels",
        "Project timeline forecasting with realistic completion dates",
        "Team capacity planning and allocation adjustment",
        "Visual probability distribution histogram",
        "Scope uncertainty modeling with min/max ranges",
        "Story split factor accounting for scope creep"
    ],
    "author": {
        "@type": "Person",
        "name": "Martin Rosén-Lidholm",
        "url": "https://github.com/MartinRL"
    },
    "datePublished": "2025-10-10",
    "dateModified": "2025-10-20"
    }
    </script>

    <!-- HowTo Schema - Monte Carlo Methodology -->
    <script type="application/ld+json">
    {
    "@context": "https://schema.org",
    "@type": "HowTo",
    "name": "How to Estimate Project Timelines Using Monte Carlo Simulation",
    "description": "Step-by-step guide to generating probabilistic project forecasts using Monte Carlo simulation technique",
    "totalTime": "PT5M",
    "estimatedCost": {
        "@type": "MonetaryAmount",
        "currency": "USD",
        "value": "0"
    },
    "tool": [
        {
        "@type": "HowToTool",
        "name": "Historical throughput data or three-point estimates"
        },
        {
        "@type": "HowToTool",
        "name": "Project scope range (min/max stories)"
        },
        {
        "@type": "HowToTool",
        "name": "Team capacity allocation percentage"
        }
    ],
    "step": [
        {
        "@type": "HowToStep",
        "position": 1,
        "name": "Choose estimation method",
        "text": "Select either Historical Data mode (recommended if you have past sprint data) or Three-Point Estimate mode (for new teams or projects)",
        "url": "https://montecarloestimation.com#estimation-method"
        },
        {
        "@type": "HowToStep",
        "position": 2,
        "name": "Enter throughput data",
        "text": "For Historical Data: Enter weekly story completion counts from past 8-12 weeks. For Three-Point Estimates: Provide pessimistic, most likely, and optimistic weekly throughput values",
        "url": "https://montecarloestimation.com#throughput"
        },
        {
        "@type": "HowToStep",
        "position": 3,
        "name": "Define project scope",
        "text": "Enter minimum and maximum story counts to account for scope uncertainty. Set split factor (1.0-2.0) to model story splitting during development",
        "url": "https://montecarloestimation.com#scope"
        },
        {
        "@type": "HowToStep",
        "position": 4,
        "name": "Set team capacity",
        "text": "Enter realistic team allocation percentage (typically 70-80%) accounting for meetings, support work, and other responsibilities",
        "url": "https://montecarloestimation.com#capacity"
        },
        {
        "@type": "HowToStep",
        "position": 5,
        "name": "Add risks (optional)",
        "text": "Define 2-5 project risks with probability (0-100%) and impact ranges (min/max stories added). Each risk is evaluated probabilistically in simulations",
        "url": "https://montecarloestimation.com#risks"
        },
        {
        "@type": "HowToStep",
        "position": 6,
        "name": "Generate forecast",
        "text": "Click 'Generate Forecast' to run 500 Monte Carlo simulations. Each simulation randomizes throughput, scope, and risk factors to produce a probability distribution",
        "url": "https://montecarloestimation.com#generate"
        },
        {
        "@type": "HowToStep",
        "position": 7,
        "name": "Interpret results",
        "text": "Review the three confidence levels: 50% (likely), 85% (safe for commitments), and 95% (conservative). Use the 85% estimate for external stakeholder commitments",
        "url": "https://montecarloestimation.com#results"
        }
    ]
    }
    </script>

    <!-- Expanded FAQPage Schema -->
    <script type="application/ld+json">
    {
    "@context": "https://schema.org",
    "@type": "FAQPage",
    "mainEntity": [
        {
        "@type": "Question",
        "name": "What is Monte Carlo simulation for project estimation?",
        "acceptedAnswer": {
            "@type": "Answer",
            "text": "Monte Carlo simulation is a probabilistic technique that runs hundreds of simulations using random sampling to predict project completion dates with confidence intervals, providing more realistic estimates than single-point predictions. Instead of a single deadline, you get a probability distribution showing likely completion ranges."
        }
        },
        {
        "@type": "Question",
        "name": "How accurate is Monte Carlo project estimation?",
        "acceptedAnswer": {
            "@type": "Answer",
            "text": "Monte Carlo simulations typically provide 85-95% accuracy when based on good historical data, significantly outperforming traditional estimation methods. The accuracy depends on quality of input data - using actual past throughput yields better results than estimates."
        }
        },
        {
        "@type": "Question",
        "name": "Is this Monte Carlo estimation tool free?",
        "acceptedAnswer": {
            "@type": "Answer",
            "text": "Yes, this Monte Carlo project estimation tool is completely free to use with no registration required. All calculations run in your browser - your project data never leaves your device."
        }
        },
        {
        "@type": "Question",
        "name": "Should I use historical data or three-point estimates?",
        "acceptedAnswer": {
            "@type": "Answer",
            "text": "Use historical data if you have tracked past sprint throughput - it's more accurate because it reflects actual team performance. Use three-point estimates only for new teams, new types of work, or when historical data isn't available. Historical data accounts for all hidden factors affecting productivity."
        }
        },
        {
        "@type": "Question",
        "name": "How many weeks of historical data should I use?",
        "acceptedAnswer": {
            "@type": "Answer",
            "text": "Recommended: 8-12 weeks of data for a good balance. Minimum: 4 weeks (less reliable). Maximum useful: 20 weeks (older data may not reflect current team reality). Include all types of weeks - good and bad - for realistic forecasts."
        }
        },
        {
        "@type": "Question",
        "name": "What confidence level should I commit to?",
        "acceptedAnswer": {
            "@type": "Answer",
            "text": "For external stakeholder commitments, use the 85% confidence level - it provides high confidence without excessive padding. Use 50% for internal planning (but expect variance). Reserve 95% for critical deadlines where failure has severe consequences."
        }
        },
        {
        "@type": "Question",
        "name": "What is the split factor in project estimation?",
        "acceptedAnswer": {
            "@type": "Answer",
            "text": "Split factor accounts for stories that get split into multiple smaller stories during development. A factor of 1.5 means for every 10 planned stories, you'll do 15 stories of work. Typical values: 1.0-1.2 for well-groomed backlogs, 1.2-1.5 for normal uncertainty, 1.5-2.0 for high uncertainty or new domains."
        }
        },
        {
        "@type": "Question",
        "name": "How do I set realistic team capacity percentage?",
        "acceptedAnswer": {
            "@type": "Answer",
            "text": "Team capacity accounts for time spent on non-project work. Typical values: 100% for dedicated teams with no other responsibilities, 70-80% for primary project with some maintenance, 50-60% for teams with significant other responsibilities. Track actual time for one week if unsure - you'll likely find attention is more fragmented than expected."
        }
        },
        {
        "@type": "Question",
        "name": "What types of risks should I add to the simulation?",
        "acceptedAnswer": {
            "@type": "Answer",
            "text": "Include 2-5 meaningful risks that might add work: legacy code refactoring, regulatory requirements, integration issues, additional platform support. Each risk needs probability (0-100%) and impact range (min/max stories added). Don't use 100% probability - if it's certain, add it to your scope range instead."
        }
        },
        {
        "@type": "Question",
        "name": "How does Monte Carlo simulation work?",
        "acceptedAnswer": {
            "@type": "Answer",
            "text": "The tool runs 500 trial simulations. Each trial: 1) Randomizes story count within your range, 2) Applies split factor for scope creep, 3) Evaluates each risk probabilistically, 4) Simulates weekly progress using randomized throughput until project completes. Results are sorted to calculate percentiles (50th, 85th, 95th) showing probability distribution of completion dates."
        }
        },
        {
        "@type": "Question",
        "name": "Can I use this for Scrum or Kanban teams?",
        "acceptedAnswer": {
            "@type": "Answer",
            "text": "Yes, Monte Carlo estimation works for any agile methodology. For Scrum, use story points or story counts completed per sprint. For Kanban, use throughput (items completed per week) from your cumulative flow diagram. The key is consistent measurement - whatever units you track, use those."
        }
        },
        {
        "@type": "Question",
        "name": "What if my story sizes vary significantly?",
        "acceptedAnswer": {
            "@type": "Answer",
            "text": "Use story points instead of story counts for throughput if story sizes vary widely. Story points normalize different-sized work items. If you don't use points, consider splitting large stories before estimation or using a higher split factor to account for the variance."
        }
        },
        {
        "@type": "Question",
        "name": "Why is Monte Carlo better than traditional estimation?",
        "acceptedAnswer": {
            "@type": "Answer",
            "text": "Traditional estimation assumes everything goes to plan - it produces single-point estimates that are wrong more often than right. Monte Carlo acknowledges uncertainty: throughput varies week to week, scope changes, risks materialize. By modeling these variables probabilistically across hundreds of scenarios, you get realistic ranges with measurable confidence levels instead of false precision."
        }
        },
        {
        "@type": "Question",
        "name": "How often should I re-run the forecast?",
        "acceptedAnswer": {
            "@type": "Answer",
            "text": "Re-run forecasts every 2-4 weeks or when significant changes occur: scope changes, team size changes, new risks identified, or actual throughput deviates from predictions. Update your historical data with recent weeks and adjust parameters based on reality. Forecasts become more accurate as you gather more data."
        }
        },
        {
        "@type": "Question",
        "name": "What does the probability distribution chart show?",
        "acceptedAnswer": {
            "@type": "Answer",
            "text": "The histogram shows how many of the 500 simulations completed in each time range. Tall bars indicate likely completion times, short bars show unlikely times. A narrow distribution means high certainty, wide distribution indicates high uncertainty. If the distribution has a long tail to the right, you have more downside risk than upside opportunity."
        }
        }
    ]
    }
    </script>

    <!-- WebPage Schema with Speakable Sections -->
    <script type="application/ld+json">
    {
    "@context": "https://schema.org",
    "@type": "WebPage",
    "name": "Monte Carlo Project Estimation Tool",
    "url": "https://montecarloestimation.com",
    "description": "Free probabilistic forecasting tool for agile project management using Monte Carlo simulations with confidence intervals",
    "speakable": {
        "@type": "SpeakableSpecification",
        "cssSelector": ["h1", ".section-title", ".result-label"]
    },
    "breadcrumb": {
        "@type": "BreadcrumbList",
        "itemListElement": [{
        "@type": "ListItem",
        "position": 1,
        "name": "Home",
        "item": "https://montecarloestimation.com"
        }]
    }
    }
    </script>

</head>
<body>
    <header>
        <a href="/" class="logo-title-link" aria-label="Go to home page">
            <svg class="header-logo" width="48" height="48" viewBox="0 0 200 200" xmlns="http://www.w3.org/2000/svg" role="img" aria-label="Monte Carlo histogram logo">
                <title>Monte Carlo histogram logo</title>
                <rect x="30" y="75" width="40" height="100" fill="#28a745"/>
                <rect x="80" y="25" width="40" height="150" fill="#ffc107"/>
                <rect x="130" y="75" width="40" height="100" fill="#dc3545"/>
            </svg>
            <div class="header-text">
                <h1>Project Estimation</h1>
                <p class="header-subtitle">Probabilistic Forecasting with Monte Carlo Simulations</p>
            </div>
        </a>
        <div class="header-help" onclick="showHelp('overview')">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <circle cx="12" cy="12" r="10"></circle>
                <path d="M9 9a3 3 0 1 1 6 0c0 2-3 3-3 3"></path>
                <line x1="12" y1="17" x2="12.01" y2="17"></line>
            </svg>
        </div>
    </header>

    <main>
    <div class="container">
        <div class="sidebar">
            <div class="section">
                <div class="section-title">
                    Estimation Method
                    <span class="info-icon" onclick="showHelp('forecastMethod')">i</span>
                </div>
                <div class="toggle-group">
                    <button class="toggle-btn active" onclick="setMode('estimate')">Three-Point Estimate</button>
                    <button class="toggle-btn" onclick="setMode('data')">Historical Data</button>
                </div>
            </div>

            <div class="section" id="estimateSection">
                <div class="section-title">
                    Throughput Estimates
                    <span class="info-icon" onclick="showHelp('estimates')">i</span>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>
                            Pessimistic
                            <span class="info-icon" onclick="showHelp('pessimistic')">i</span>
                        </label>
                        <input type="number" id="throughputLow" value="1" min="0" step="0.5">
                    </div>
                    <div class="form-group">
                        <label>
                            Optimistic
                            <span class="info-icon" onclick="showHelp('optimistic')">i</span>
                        </label>
                        <input type="number" id="throughputHigh" value="10" min="0" step="0.5">
                    </div>
                </div>
                <div class="form-group">
                    <label>
                        Most Likely
                        <span class="info-icon" onclick="showHelp('mostLikely')">i</span>
                    </label>
                    <input type="number" id="throughputMostLikely" value="3" min="0" step="0.5">
                    <div class="help-text">Leave empty for uniform distribution</div>
                </div>
            </div>

            <div class="section" id="dataSection" style="display: none;">
                <div class="section-title">
                    Historical Weekly Throughput
                    <span class="info-icon" onclick="showHelp('historicalData')">i</span>
                </div>
                <div class="form-group">
                    <label>
                        Weekly Samples
                        <span class="info-icon" onclick="showHelp('weeklySamples')">i</span>
                    </label>
                    <textarea id="historicalData" placeholder="Enter one value per line&#10;Example:&#10;3&#10;5&#10;2&#10;7&#10;4">3
5
2
7
4
6
3
8
5
4</textarea>
                    <div class="help-text">Stories completed per week from past sprints</div>
                </div>
            </div>
            
            <div class="section">
                <div class="section-title">
                    Project Scope
                    <span class="info-icon" onclick="showHelp('scope')">i</span>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>
                            Min Stories
                            <span class="info-icon" onclick="showHelp('minStories')">i</span>
                        </label>
                        <input type="number" id="storyCountLow" value="20" min="1">
                    </div>
                    <div class="form-group">
                        <label>
                            Max Stories
                            <span class="info-icon" onclick="showHelp('maxStories')">i</span>
                        </label>
                        <input type="number" id="storyCountHigh" value="40" min="1">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>
                            Split Factor Min
                            <span class="info-icon" onclick="showHelp('splitRate')">i</span>
                        </label>
                        <input type="number" id="splitRateLow" value="1.0" min="1" step="0.1">
                    </div>
                    <div class="form-group">
                        <label>Split Factor Max</label>
                        <input type="number" id="splitRateHigh" value="1.5" min="1" step="0.1">
                    </div>
                </div>
                <div class="help-text">Split factor accounts for stories discovered during development</div>
            </div>
            
            <div class="section">
                <div class="section-title">
                    Team Capacity
                    <span class="info-icon" onclick="showHelp('teamFocus')">i</span>
                </div>
                <div class="form-group">
                    <label>
                        Team Allocation (%)
                        <span class="info-icon" onclick="showHelp('teamAllocation')">i</span>
                    </label>
                    <input type="number" id="focusPercentage" value="80" min="0" max="100" step="10">
                    <div class="help-text">Percentage of team capacity dedicated to this work</div>
                </div>
            </div>
            
            <div class="section">
                <div class="section-title">
                    Project Risks (Optional)
                    <span class="info-icon" onclick="showHelp('risks')">i</span>
                </div>
                <div id="riskContainer"></div>
                <button class="add-risk-btn" onclick="addRisk()">+ Add Risk</button>
            </div>
            
            <div class="button-row">
                <button class="run-btn" id="runButton" onclick="runSimulation()">
                    Generate Forecast
                </button>
                <button type="button"
                        id="shareButton"
                        class="share-btn share-btn-hidden"
                        onclick="shareConfiguration()">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8"></path>
                        <polyline points="16 6 12 2 8 6"></polyline>
                        <line x1="12" y1="2" x2="12" y2="15"></line>
                    </svg>
                    <span id="shareButtonText">Share</span>
                </button>
            </div>
        </div>
        
        <div class="results">
            <div id="results">
                <div class="empty-state">
                    <h2>Ready to Forecast</h2>
                    <p>Configure your parameters and click "Generate Forecast"</p>
                    <p style="margin-top: 1rem; font-size: 0.9rem;">This tool runs 500 Monte Carlo simulations using a triangular distribution, which acknowledges that extreme values (very low or very high throughput) are less likely than values near your "most likely" estimate, creating more realistic project completion timelines with confidence intervals.</p>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Modal for help content -->
    <div class="modal" id="helpModal" onclick="closeModalOnBackground(event)">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title" id="modalTitle">Help</h2>
                <button class="modal-close" onclick="closeModal()">×</button>
            </div>
            <div class="modal-body" id="modalBody">
                <!-- Content will be inserted here -->
            </div>
        </div>
    </div>

    <script>
        let mode = 'estimate'; // Default mode matches the active button in HTML
        let risks = [];
        let results = [];

        // Google Analytics 4 Helper Function
        // Safely calls gtag only if it's defined (when GA4 is enabled)
        function trackEvent(eventName, eventParams) {
            if (typeof gtag !== 'undefined') {
                gtag('event', eventName, eventParams);
            }
        }

        // URL Sharing Functions
        function serializeToURL() {
            const params = new URLSearchParams();

            // Mode
            params.set('m', mode === 'estimate' ? 'e' : 'd');

            // Common parameters (skip defaults to keep URL short)
            const scl = parseInt(document.getElementById('storyCountLow').value);
            const sch = parseInt(document.getElementById('storyCountHigh').value);
            const srl = parseFloat(document.getElementById('splitRateLow').value);
            const srh = parseFloat(document.getElementById('splitRateHigh').value);
            const fp = parseInt(document.getElementById('focusPercentage').value);

            if (scl !== 20) params.set('scl', scl);
            if (sch !== 40) params.set('sch', sch);
            if (srl !== 1.0) params.set('srl', srl);
            if (srh !== 1.5) params.set('srh', srh);
            if (fp !== 80) params.set('fp', fp);

            // Mode-specific parameters
            if (mode === 'estimate') {
                const tl = parseFloat(document.getElementById('throughputLow').value);
                const th = parseFloat(document.getElementById('throughputHigh').value);
                const tm = document.getElementById('throughputMostLikely').value;

                params.set('tl', tl);
                params.set('th', th);
                if (tm) params.set('tm', parseFloat(tm));
            } else {
                // Historical data mode
                const samples = getHistoricalSamples();
                if (samples.length > 0) {
                    params.set('hd', samples.join(','));
                }
            }

            // Risks (if any)
            risks.forEach((risk, index) => {
                params.set(`r${index}p`, risk.probability);
                params.set(`r${index}i`, risk.minImpact);
                params.set(`r${index}a`, risk.maxImpact);
                // Only include description if it's not empty and keep it short
                if (risk.description && risk.description.trim()) {
                    params.set(`r${index}d`, risk.description.substring(0, 30));
                }
            });

            return window.location.origin + '/?' + params.toString();
        }

        function loadFromURL() {
            const params = new URLSearchParams(window.location.search);

            // Check if there's a configuration in the URL
            if (!params.has('m')) return false;

            try {
                // Set mode
                const modeParam = params.get('m');
                mode = modeParam === 'e' ? 'estimate' : 'data';
                updateModeUI();

                // Load common parameters with defaults
                document.getElementById('storyCountLow').value = params.get('scl') || '20';
                document.getElementById('storyCountHigh').value = params.get('sch') || '40';
                document.getElementById('splitRateLow').value = params.get('srl') || '1.0';
                document.getElementById('splitRateHigh').value = params.get('srh') || '1.5';
                document.getElementById('focusPercentage').value = params.get('fp') || '80';

                // Load mode-specific parameters
                if (mode === 'estimate') {
                    document.getElementById('throughputLow').value = params.get('tl') || '1';
                    document.getElementById('throughputHigh').value = params.get('th') || '10';
                    const tm = params.get('tm');
                    if (tm) {
                        document.getElementById('throughputMostLikely').value = tm;
                    }
                } else {
                    // Historical data mode
                    const hdParam = params.get('hd');
                    if (hdParam) {
                        document.getElementById('historicalData').value = hdParam.split(',').join('\n');
                    }
                }

                // Load risks
                risks = [];
                for (let i = 0; i < 5; i++) { // Max 5 risks
                    if (params.has(`r${i}p`)) {
                        const risk = {
                            id: Date.now() + i,
                            name: `Risk ${i + 1}`,
                            probability: parseInt(params.get(`r${i}p`)) || 20,
                            minImpact: parseInt(params.get(`r${i}i`)) || 0,
                            maxImpact: parseInt(params.get(`r${i}a`)) || 10,
                            description: params.get(`r${i}d`) || ''
                        };
                        risks.push(risk);
                    }
                }

                // Render risks if any were loaded
                if (risks.length > 0) {
                    renderRisks();
                }

                return true;
            } catch (error) {
                console.error('Error loading configuration from URL:', error);
                return false;
            }
        }

        function updateModeUI() {
            // Update toggle buttons to reflect current mode
            document.querySelectorAll('.toggle-btn').forEach(btn => {
                btn.classList.remove('active');
            });

            // Find the correct button based on mode
            const buttons = document.querySelectorAll('.toggle-btn');
            if (mode === 'estimate') {
                buttons[0].classList.add('active'); // First button is Three-Point Estimate
            } else {
                buttons[1].classList.add('active'); // Second button is Historical Data
            }

            // Show/hide sections
            document.getElementById('dataSection').style.display =
                mode === 'data' ? 'block' : 'none';
            document.getElementById('estimateSection').style.display =
                mode === 'estimate' ? 'block' : 'none';
        }

        async function shareConfiguration() {
            const url = window.location.href;

            try {
                await navigator.clipboard.writeText(url);

                // Visual feedback
                const button = document.getElementById('shareButton');
                const buttonText = document.getElementById('shareButtonText');
                const originalText = buttonText.textContent;

                button.classList.add('copied');
                buttonText.textContent = 'Copied!';
                button.disabled = true;

                setTimeout(() => {
                    button.classList.remove('copied');
                    buttonText.textContent = originalText;
                    button.disabled = false;
                }, 2000);

                // Track analytics event
                trackEvent('share_forecast', {
                    'event_category': 'engagement',
                    'event_action': 'share',
                    'url_length': url.length,
                    'mode': mode,
                    'has_risks': risks.length > 0,
                    'risk_count': risks.length
                });
            } catch (err) {
                // Fallback for older browsers - show alert with URL
                alert('Copy this link to share your forecast configuration:\n\n' + url);

                trackEvent('share_forecast', {
                    'event_category': 'engagement',
                    'event_action': 'share_fallback'
                });
            }
        }

        const helpContent = {
            overview: {
                title: "How Monte Carlo Project Estimation Works",
                content: `
                    <h3>What is Monte Carlo Simulation?</h3>
                    <p>Instead of giving you a single "best guess" deadline, this tool runs hundreds of possible scenarios based on your data. It's like playing out your project 500 times with different combinations of good days, bad days, and unexpected events.</p>
                    
                    <h3>Why is this better than traditional estimation?</h3>
                    <p>Traditional planning assumes everything goes according to plan. This tool acknowledges that:</p>
                    <ul>
                        <li>Some weeks you'll complete more work than others</li>
                        <li>Scope might grow as you discover complexity</li>
                        <li>Unexpected issues will arise</li>
                        <li>Team capacity varies due to meetings, holidays, and other commitments</li>
                    </ul>
                    
                    <h3>How to use this tool</h3>
                    <p>1. Choose whether to use your historical data (recommended) or estimates</p>
                    <p>2. Enter your scope range (minimum to maximum stories)</p>
                    <p>3. Adjust team allocation based on realistic availability</p>
                    <p>4. Add any known risks that might add work</p>
                    <p>5. Generate your forecast to see likely completion dates</p>
                    
                    <div class="example-box">
                        <strong>Pro tip:</strong> The "85% Confidence" estimate is what you should communicate to stakeholders. The "50% Confidence" is essentially a coin flip - half the time you'll finish earlier, half the time later.
                    </div>
                `
            },
            forecastMethod: {
                title: "Choosing Your Forecast Method",
                content: `
                    <h3>Use Historical Data (Recommended)</h3>
                    <p>If you have tracked how many stories your team completed in past weeks, use this method. It's the most accurate because it's based on what your team actually achieves, not what you hope to achieve.</p>
                    
                    <div class="example-box">
                        <strong>Example:</strong> If in the last 10 weeks you completed: 3, 5, 2, 7, 4, 6, 3, 8, 5, 4 stories, the simulation will randomly sample from these values for each simulated week.
                    </div>
                    
                    <h3>Use Three-Point Estimates</h3>
                    <p>If you're starting fresh or don't have historical data, use estimates. You'll provide:</p>
                    <ul>
                        <li><strong>Pessimistic:</strong> The worst-case weekly throughput</li>
                        <li><strong>Optimistic:</strong> The best-case weekly throughput</li>
                        <li><strong>Most Likely:</strong> What you typically expect</li>
                    </ul>
                    
                    <p>The tool uses a triangular distribution, which means values near "Most Likely" occur more often than extreme values.</p>
                `
            },
            historicalData: {
                title: "Using Historical Throughput Data",
                content: `
                    <h3>What is throughput?</h3>
                    <p>Throughput is the number of stories (or work items) your team completes in a time period. For this tool, we typically use weekly throughput.</p>
                    
                    <h3>How to collect this data</h3>
                    <p>Look back at your last 4-12 weeks and count how many stories were marked "Done" each week. Include:</p>
                    <ul>
                        <li>Weeks with holidays or team absences (these are realistic)</li>
                        <li>Both good and bad weeks</li>
                        <li>Any week that represents normal operations</li>
                    </ul>
                    
                    <div class="example-box">
                        <strong>Example data entry:</strong><br>
                        3 (week with a holiday)<br>
                        5 (normal week)<br>
                        2 (someone was sick)<br>
                        7 (great week)<br>
                        4 (normal week)
                    </div>
                    
                    <h3>Why this works</h3>
                    <p>Your past performance is the best predictor of future performance. This method automatically accounts for all the hidden factors that affect productivity: meetings, context switching, technical debt, etc.</p>
                `
            },
            weeklySamples: {
                title: "Weekly Throughput Samples",
                content: `
                    <h3>What to enter here</h3>
                    <p>Enter the actual number of stories your team completed each week. One number per line.</p>
                    
                    <h3>How many weeks of data?</h3>
                    <ul>
                        <li><strong>Minimum:</strong> 4 weeks (less reliable)</li>
                        <li><strong>Recommended:</strong> 8-12 weeks (good balance)</li>
                        <li><strong>Maximum useful:</strong> 20 weeks (older data may not reflect current reality)</li>
                    </ul>
                    
                    <div class="example-box">
                        <strong>Data quality tips:</strong><br>
                        • Use consistent story sizes (or use story points)<br>
                        • Include all types of weeks (good and bad)<br>
                        • Don't cherry-pick only your best weeks<br>
                        • If story sizes vary wildly, consider using story points instead
                    </div>
                `
            },
            estimates: {
                title: "Understanding Throughput Estimates",
                content: `
                    <h3>When to use estimates</h3>
                    <p>Use estimates when you don't have historical data, such as:</p>
                    <ul>
                        <li>New team formations</li>
                        <li>New type of work</li>
                        <li>Significant process changes</li>
                    </ul>
                    
                    <h3>The three-point estimation technique</h3>
                    <p>Instead of one number, you provide three to capture uncertainty:</p>
                    
                    <div class="example-box">
                        <strong>Example for a team of 4 developers:</strong><br>
                        • Pessimistic: 1 story/week (everything goes wrong)<br>
                        • Most Likely: 3 stories/week (normal pace)<br>
                        • Optimistic: 10 stories/week (everything goes perfectly)
                    </div>
                    
                    <p>The simulation will use these to create a realistic distribution of possible throughputs, with values near "Most Likely" occurring most often.</p>
                `
            },
            pessimistic: {
                title: "Pessimistic Throughput",
                content: `
                    <h3>What is pessimistic throughput?</h3>
                    <p>This is your team's throughput during the worst reasonable weeks. Not catastrophic failure, but when things are genuinely difficult.</p>
                    
                    <h3>Consider these factors:</h3>
                    <ul>
                        <li>Key team members absent</li>
                        <li>Difficult technical challenges</li>
                        <li>High meeting load</li>
                        <li>Integration issues</li>
                        <li>Learning curve on new technology</li>
                    </ul>
                    
                    <div class="example-box">
                        <strong>How to estimate:</strong> Think about your worst productive week in the last quarter (excluding complete shutdowns). How many stories did you complete?
                    </div>
                `
            },
            optimistic: {
                title: "Optimistic Throughput",
                content: `
                    <h3>What is optimistic throughput?</h3>
                    <p>This is your team's throughput when everything goes smoothly. Not miracles, but when you're in the flow.</p>
                    
                    <h3>This assumes:</h3>
                    <ul>
                        <li>No blockers or dependencies</li>
                        <li>Clear requirements</li>
                        <li>Minimal meetings</li>
                        <li>Team at full strength</li>
                        <li>Work that plays to team strengths</li>
                    </ul>
                    
                    <div class="example-box">
                        <strong>How to estimate:</strong> Think about your best week in the last quarter. How many stories did you complete when everything clicked?
                    </div>
                    
                    <p><strong>Warning:</strong> Don't use your absolute best week ever. Pick something sustainable that could happen again.</p>
                `
            },
            mostLikely: {
                title: "Most Likely Throughput",
                content: `
                    <h3>What is most likely throughput?</h3>
                    <p>This is your typical, average week. Not good, not bad, just normal operations with the usual mix of progress and obstacles.</p>
                    
                    <h3>Why this matters</h3>
                    <p>When provided, the simulation uses a triangular distribution, making values near this "most likely" number occur more frequently than extreme values. This creates more realistic forecasts.</p>
                    
                    <div class="example-box">
                        <strong>Leaving it empty:</strong> If you don't provide this value, the simulation assumes all values between pessimistic and optimistic are equally likely (uniform distribution), which is less realistic.
                    </div>
                    
                    <h3>How to estimate</h3>
                    <p>Look at your last 10 weeks and pick the median value, or ask: "If I had to bet on our throughput next week, what would I guess?"</p>
                `
            },
            scope: {
                title: "Understanding Project Scope",
                content: `
                    <h3>Why a range instead of a fixed number?</h3>
                    <p>Scope is rarely fixed in reality. Using a range acknowledges that:</p>
                    <ul>
                        <li>Requirements may be incomplete</li>
                        <li>Some stories will be simpler than expected</li>
                        <li>Some stories will reveal hidden complexity</li>
                        <li>Stakeholders might add or remove features</li>
                    </ul>
                    
                    <h3>How to estimate your range</h3>
                    <p><strong>Minimum:</strong> Count only the stories you're absolutely certain about. Must-haves with clear requirements.</p>
                    <p><strong>Maximum:</strong> Include all must-haves, likely additions, and stories that might be discovered during development.</p>
                    
                    <div class="example-box">
                        <strong>Example:</strong><br>
                        Minimum: 20 stories (core features everyone agrees on)<br>
                        Maximum: 40 stories (core + nice-to-haves + likely discoveries)
                    </div>
                `
            },
            minStories: {
                title: "Minimum Stories",
                content: `
                    <h3>What to include in minimum</h3>
                    <p>Only count stories that are:</p>
                    <ul>
                        <li>Definitely required (true must-haves)</li>
                        <li>Well understood</li>
                        <li>Unlikely to be descoped</li>
                    </ul>
                    
                    <h3>Common mistake</h3>
                    <p>Don't use the "official" scope number here if you know it's optimistic. Be honest about the absolute minimum viable delivery.</p>
                    
                    <div class="example-box">
                        <strong>Think:</strong> "If we had to ship tomorrow due to an emergency, what's the absolute minimum that would be acceptable?"
                    </div>
                `
            },
            maxStories: {
                title: "Maximum Stories",
                content: `
                    <h3>What to include in maximum</h3>
                    <p>Include everything that might reasonably end up in scope:</p>
                    <ul>
                        <li>All must-haves</li>
                        <li>Likely scope creep</li>
                        <li>Technical debt that might be addressed</li>
                        <li>Stories that will likely split into multiple stories</li>
                        <li>"Nice-to-haves" that stakeholders keep mentioning</li>
                    </ul>
                    
                    <div class="example-box">
                        <strong>Rule of thumb:</strong> If there's a 20% or higher chance something will be included, count it here.
                    </div>
                    
                    <h3>Don't go crazy</h3>
                    <p>This isn't about worst-case scenario planning. Just be realistic about what typically happens to scope during projects.</p>
                `
            },
            splitRate: {
                title: "Story Split Factor",
                content: `
                    <h3>What is story splitting?</h3>
                    <p>During development, teams often discover that a single story is too large and needs to be split into multiple smaller stories. This is normal and healthy, but affects timeline.</p>
                    
                    <h3>How split factor works</h3>
                    <p>A split factor of 1.5 means that for every 10 stories you planned, you'll actually end up doing 15 stories worth of work.</p>
                    
                    <div class="example-box">
                        <strong>Example:</strong><br>
                        Original: "User can manage profile"<br>
                        After splitting:<br>
                        • "User can view profile"<br>
                        • "User can edit profile"<br>
                        • "User can upload avatar"
                    </div>
                    
                    <h3>Typical values</h3>
                    <ul>
                        <li><strong>1.0-1.2:</strong> Well-groomed backlog, experienced team</li>
                        <li><strong>1.2-1.5:</strong> Some uncertainty, normal discovery</li>
                        <li><strong>1.5-2.0:</strong> High uncertainty, new domain</li>
                    </ul>
                `
            },
            teamFocus: {
                title: "Understanding Team Focus",
                content: `
                    <h3>What is team focus?</h3>
                    <p>Teams rarely spend 100% of their time on a single project. Team focus accounts for the realistic percentage of time your team can dedicate to this specific work.</p>
                    
                    <h3>Common distractions include:</h3>
                    <ul>
                        <li>Supporting production issues</li>
                        <li>Meetings not related to this project</li>
                        <li>Other projects or initiatives</li>
                        <li>Training and development time</li>
                        <li>Administrative tasks</li>
                    </ul>
                    
                    <h3>How to estimate</h3>
                    <p>Track where time actually goes for one week, or use these guidelines:</p>
                    <ul>
                        <li><strong>100%:</strong> Dedicated team, no other responsibilities</li>
                        <li><strong>70-80%:</strong> Primary project, some maintenance work</li>
                        <li><strong>50-60%:</strong> Significant other responsibilities</li>
                        <li><strong>30-40%:</strong> This is one of several priorities</li>
                    </ul>
                `
            },
            teamAllocation: {
                title: "Team Allocation Percentage",
                content: `
                    <h3>Be realistic, not optimistic</h3>
                    <p>This is about actual time spent making progress on stories, not time "assigned" to the project.</p>
                    
                    <div class="example-box">
                        <strong>Example calculation:</strong><br>
                        40 hours/week per person<br>
                        -8 hours of meetings<br>
                        -4 hours of code reviews<br>
                        -4 hours of production support<br>
                        -4 hours of helping others<br>
                        = 20 hours (50%) actual project time
                    </div>
                    
                    <h3>Common mistake</h3>
                    <p>Teams often overestimate their focus. If unsure, track actual time for one week. You'll likely be surprised how fragmented attention really is.</p>
                    
                    <h3>Impact on forecast</h3>
                    <p>If you set 80%, the simulation will apply 80% of your throughput each week. So if you could do 5 stories with full focus, you'll complete 4 stories.</p>
                `
            },
            risks: {
                title: "Project Risk Management",
                content: `
                    <h3>What are risks in this context?</h3>
                    <p>Risks are events that might happen and would add extra work to your project. Not disasters, but realistic possibilities that would expand scope.</p>
                    
                    <h3>Examples of project risks</h3>
                    <ul>
                        <li>Need to refactor legacy code (30% chance, adds 5-10 stories)</li>
                        <li>New regulatory requirement (20% chance, adds 10-20 stories)</li>
                        <li>Major integration issues (15% chance, adds 3-8 stories)</li>
                        <li>Additional browser/device support (40% chance, adds 5-7 stories)</li>
                    </ul>
                    
                    <h3>How risks work in the simulation</h3>
                    <p>For each simulation run, the tool "rolls the dice" for each risk:</p>
                    <ul>
                        <li>If a 30% risk is defined, it will occur in roughly 150 out of 500 simulations</li>
                        <li>When it occurs, a random number of stories between min and max impact is added</li>
                        <li>Multiple risks can trigger in the same simulation</li>
                    </ul>
                    
                    <h3>Don't overdo it</h3>
                    <p>Include 2-5 meaningful risks. Too many risks make the forecast overly pessimistic and less useful.</p>
                `
            },
            riskProbability: {
                title: "Risk Probability",
                content: `
                    <h3>What is risk probability?</h3>
                    <p>The likelihood that this risk will actually occur during your project, expressed as a percentage (0-100%).</p>
                    
                    <h3>How to estimate probability</h3>
                    <ul>
                        <li><strong>10-20%:</strong> Unlikely but possible</li>
                        <li><strong>30-40%:</strong> Moderate chance</li>
                        <li><strong>50-60%:</strong> Likely to happen</li>
                        <li><strong>70%+:</strong> Very likely (consider if this should just be in scope)</li>
                    </ul>
                    
                    <div class="example-box">
                        <strong>Example:</strong> If you've needed to support IE11 on 3 out of your last 10 projects, that's a 30% probability for browser compatibility risk.
                    </div>
                    
                    <h3>Common mistake</h3>
                    <p>Don't use 100% probability - if something is certain, it should be in your min/max scope range, not a risk.</p>
                `
            },
            riskImpact: {
                title: "Risk Impact (Stories Added)",
                content: `
                    <h3>What is risk impact?</h3>
                    <p>The number of additional stories that would be added to your project if this risk occurs.</p>
                    
                    <h3>Min vs Max impact</h3>
                    <ul>
                        <li><strong>Min Impact:</strong> Best case if the risk occurs (minor complication)</li>
                        <li><strong>Max Impact:</strong> Worst case if the risk occurs (major complication)</li>
                    </ul>
                    
                    <div class="example-box">
                        <strong>Example - Integration Risk:</strong><br>
                        Min Impact: 3 stories (simple API adjustments)<br>
                        Max Impact: 10 stories (complete redesign of integration layer)
                    </div>
                    
                    <h3>Sizing guidance</h3>
                    <p>Think in terms of your normal story size. If a risk could add a week of work and you typically complete 5 stories per week, that's 5 stories of impact.</p>
                `
            },
            confidence50: {
                title: "50% Confidence Level",
                content: `
                    <h3>What does 50% confidence mean?</h3>
                    <p>You have a 50/50 chance of completing by this date. It's like flipping a coin - half the simulations finished before this date, half finished after.</p>
                    
                    <h3>When to use this estimate</h3>
                    <ul>
                        <li>Internal planning discussions</li>
                        <li>Best-case scenarios</li>
                        <li>When you have flexibility to adjust</li>
                    </ul>
                    
                    <div class="example-box">
                        <strong>Warning:</strong> Never commit to external stakeholders using 50% confidence. You'll miss the deadline half the time!
                    </div>
                `
            },
            confidence85: {
                title: "85% Confidence Level",
                content: `
                    <h3>What does 85% confidence mean?</h3>
                    <p>You have an 85% chance of completing by this date. Only 15% of simulations (75 out of 500) finished later than this.</p>
                    
                    <h3>When to use this estimate</h3>
                    <ul>
                        <li><strong>External commitments</strong></li>
                        <li><strong>Stakeholder communications</strong></li>
                        <li><strong>Contract negotiations</strong></li>
                        <li><strong>Public announcements</strong></li>
                    </ul>
                    
                    <div class="example-box">
                        <strong>Best practice:</strong> This is the sweet spot for commitments. High confidence without excessive padding.
                    </div>
                `
            },
            confidence95: {
                title: "95% Confidence Level",
                content: `
                    <h3>What does 95% confidence mean?</h3>
                    <p>You're almost certain to complete by this date. Only 5% of simulations (25 out of 500) finished later.</p>
                    
                    <h3>When to use this estimate</h3>
                    <ul>
                        <li>Fixed deadlines with severe consequences</li>
                        <li>Regulatory compliance dates</li>
                        <li>Major public events</li>
                        <li>When failure is not an option</li>
                    </ul>
                    
                    <div class="example-box">
                        <strong>Trade-off:</strong> While very safe, this estimate might be too conservative for regular use. Reserve it for critical deadlines.
                    </div>
                `
            },
            distributionChart: {
                title: "Understanding the Distribution Chart",
                content: `
                    <h3>What this chart shows</h3>
                    <p>The distribution of all 500 simulation results. Each bar shows how many simulations completed in that time frame.</p>
                    
                    <h3>How to read it</h3>
                    <ul>
                        <li><strong>Height (Y-axis):</strong> Frequency - what percentage of simulations finished in this timeframe</li>
                        <li><strong>Position (X-axis):</strong> Weeks to completion</li>
                        <li><strong>Tall bars:</strong> More likely completion times</li>
                        <li><strong>Short bars:</strong> Less likely completion times</li>
                    </ul>
                    
                    <h3>What to look for</h3>
                    <ul>
                        <li><strong>Narrow distribution:</strong> More certainty about timeline</li>
                        <li><strong>Wide distribution:</strong> High uncertainty, many variables</li>
                        <li><strong>Skewed right:</strong> Risk of delays is higher than chance of early completion</li>
                    </ul>
                    
                    <div class="example-box">
                        <strong>Insight:</strong> If the distribution has a long tail to the right, you have more downside risk than upside opportunity.
                    </div>
                `
            }
        };
        
        function showHelp(topic) {
            const content = helpContent[topic];
            if (content) {
                document.getElementById('modalTitle').textContent = content.title;
                document.getElementById('modalBody').innerHTML = content.content;
                document.getElementById('helpModal').classList.add('active');
                document.body.style.overflow = 'hidden';

                // Track help modal views
                trackEvent('view_help', {
                    'event_category': 'engagement',
                    'help_topic': topic
                });
            }
        }
        
        function closeModal() {
            document.getElementById('helpModal').classList.remove('active');
            document.body.style.overflow = '';
        }
        
        function closeModalOnBackground(event) {
            if (event.target === event.currentTarget) {
                closeModal();
            }
        }
        
        // Close modal on Escape key
        document.addEventListener('keydown', function(event) {
            if (event.key === 'Escape') {
                closeModal();
            }
        });
        
        function setMode(newMode) {
            mode = newMode;
            document.querySelectorAll('.toggle-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');

            document.getElementById('dataSection').style.display = mode === 'data' ? 'block' : 'none';
            document.getElementById('estimateSection').style.display = mode === 'estimate' ? 'block' : 'none';

            // Track estimation method selection
            trackEvent('select_estimation_mode', {
                'event_category': 'configuration',
                'method': newMode === 'data' ? 'historical' : 'three_point'
            });
        }
        
        function addRisk() {
            if (risks.length < 5) {
                const riskId = Date.now();
                risks.push({
                    id: riskId,
                    name: `Risk ${risks.length + 1}`,
                    probability: 20,
                    minImpact: 5,
                    maxImpact: 10,
                    description: ''
                });
                renderRisks();

                // Track risk addition
                trackEvent('add_risk', {
                    'event_category': 'configuration',
                    'risk_count': risks.length
                });
            }
        }
        
        function removeRisk(id) {
            risks = risks.filter(r => r.id !== id);
            renderRisks();
        }
        
        function updateRisk(id, field, value) {
            const risk = risks.find(r => r.id === id);
            if (risk) {
                if (field === 'probability') {
                    risk[field] = Math.min(100, Math.max(0, parseFloat(value) || 0));
                } else if (field === 'minImpact' || field === 'maxImpact') {
                    risk[field] = Math.max(0, parseInt(value) || 0);
                } else {
                    risk[field] = value;
                }
            }
        }
        
        function renderRisks() {
            const container = document.getElementById('riskContainer');
            
            if (risks.length === 0) {
                container.innerHTML = '<p style="color: #666; font-size: 0.9rem; text-align: center; padding: 1rem;">No risks added yet. Risks are optional but help create more realistic forecasts.</p>';
                return;
            }
            
            container.innerHTML = risks.map(risk => `
                <div class="risk-card">
                    <div class="risk-header">
                        <div class="risk-title">
                            ${risk.name}
                            <span class="info-icon" onclick="showHelp('riskCard')" style="margin-left: 0.5rem;">i</span>
                        </div>
                        <button class="risk-remove" onclick="removeRisk(${risk.id})">Remove</button>
                    </div>
                    <div class="risk-fields">
                        <div class="risk-field">
                            <label>
                                Chance (%)
                                <span class="info-icon" onclick="showHelp('riskProbability')">i</span>
                            </label>
                            <input type="number" 
                                   value="${risk.probability}" 
                                   min="0" max="100" step="5"
                                   onchange="updateRisk(${risk.id}, 'probability', this.value)">
                        </div>
                        <div class="risk-field">
                            <label>
                                Min Stories
                                <span class="info-icon" onclick="showHelp('riskImpact')">i</span>
                            </label>
                            <input type="number" 
                                   value="${risk.minImpact}" 
                                   min="0"
                                   onchange="updateRisk(${risk.id}, 'minImpact', this.value)">
                        </div>
                        <div class="risk-field">
                            <label>Max Stories</label>
                            <input type="number" 
                                   value="${risk.maxImpact}" 
                                   min="0"
                                   onchange="updateRisk(${risk.id}, 'maxImpact', this.value)">
                        </div>
                    </div>
                    <div class="risk-description">
                        <input type="text" 
                               placeholder="Describe this risk (e.g., 'Integration complexity', 'Scope creep')"
                               value="${risk.description}"
                               onchange="updateRisk(${risk.id}, 'description', this.value)">
                    </div>
                </div>
            `).join('');
        }
        
        // Add new help content for risk card
        helpContent.riskCard = {
            title: "Risk Card",
            content: `
                <h3>How to define a risk</h3>
                <p>Each risk card represents something that might happen during your project that would add work.</p>
                
                <h3>Fields to fill in:</h3>
                <ul>
                    <li><strong>Chance (%):</strong> How likely is this risk? (0-100%)</li>
                    <li><strong>Min Stories:</strong> If it happens, minimum stories added</li>
                    <li><strong>Max Stories:</strong> If it happens, maximum stories added</li>
                    <li><strong>Description:</strong> What is this risk? (for your reference)</li>
                </ul>
                
                <div class="example-box">
                    <strong>Example Risk:</strong><br>
                    Chance: 30%<br>
                    Min Stories: 5<br>
                    Max Stories: 15<br>
                    Description: "Legacy system integration issues"
                </div>
            `
        };
        
        function getHistoricalSamples() {
            const text = document.getElementById('historicalData').value;
            return text.split('\n')
                .map(line => parseFloat(line.trim()))
                .filter(val => !isNaN(val) && val > 0);
        }
        
        async function runSimulation() {
            const button = document.getElementById('runButton');
            button.disabled = true;
            button.textContent = 'Running Simulations...';
            
            await new Promise(resolve => setTimeout(resolve, 100));
            
            const params = {
                storyCountLow: parseInt(document.getElementById('storyCountLow').value),
                storyCountHigh: parseInt(document.getElementById('storyCountHigh').value),
                splitRateLow: parseFloat(document.getElementById('splitRateLow').value),
                splitRateHigh: parseFloat(document.getElementById('splitRateHigh').value),
                focusPercentage: parseFloat(document.getElementById('focusPercentage').value) / 100,
                mode: mode
            };
            
            if (mode === 'data') {
                params.samples = getHistoricalSamples();
                if (params.samples.length === 0) {
                    alert('Please enter historical data');
                    button.disabled = false;
                    button.textContent = 'Generate Forecast';
                    return;
                }
            } else {
                params.throughputLow = parseFloat(document.getElementById('throughputLow').value);
                params.throughputHigh = parseFloat(document.getElementById('throughputHigh').value);
                params.throughputMostLikely = parseFloat(document.getElementById('throughputMostLikely').value) || null;
            }
            
            results = [];
            for (let i = 0; i < 500; i++) {
                results.push(runTrial(params));
            }
            
            results.sort((a, b) => a - b);
            displayResults();

            // Track forecast generation (most important event!)
            trackEvent('generate_forecast', {
                'event_category': 'engagement',
                'event_label': mode,
                'value': 1
            });

            button.disabled = false;
            button.textContent = 'Generate Forecast';

            // Update browser URL to reflect current configuration
            const shareableUrl = serializeToURL();
            history.replaceState(null, '', shareableUrl);
        }
        
        function runTrial(params) {
            const baseStories = Math.floor(Math.random() * (params.storyCountHigh - params.storyCountLow + 1)) + params.storyCountLow;
            const splitRate = params.splitRateLow + Math.random() * (params.splitRateHigh - params.splitRateLow);
            let totalStories = Math.ceil(baseStories * splitRate);
            
            risks.forEach(risk => {
                if (Math.random() * 100 < risk.probability) {
                    const impact = Math.floor(Math.random() * (risk.maxImpact - risk.minImpact + 1)) + risk.minImpact;
                    totalStories += impact;
                }
            });
            
            let remaining = totalStories;
            let weeks = 0;
            
            while (remaining > 0 && weeks < 200) {
                let throughput;
                
                if (params.mode === 'data') {
                    throughput = params.samples[Math.floor(Math.random() * params.samples.length)];
                } else {
                    if (params.throughputMostLikely) {
                        throughput = generateTriangular(params.throughputLow, params.throughputMostLikely, params.throughputHigh);
                    } else {
                        throughput = params.throughputLow + Math.random() * (params.throughputHigh - params.throughputLow);
                    }
                }
                
                remaining -= throughput * params.focusPercentage;
                weeks++;
            }
            
            return weeks;
        }
        
        function generateTriangular(min, mode, max) {
            const u = Math.random();
            const fc = (mode - min) / (max - min);
            
            if (u <= fc) {
                return min + Math.sqrt(u * (max - min) * (mode - min));
            } else {
                return max - Math.sqrt((1 - u) * (max - min) * (max - mode));
            }
        }
        
        function getPercentile(p) {
            const index = Math.ceil((p / 100) * results.length) - 1;
            return results[Math.max(0, Math.min(index, results.length - 1))];
        }
        
        function displayResults() {
            const p50 = getPercentile(50);
            const p85 = getPercentile(85);
            const p95 = getPercentile(95);
            
            const today = new Date();
            const dateOptions = { month: 'short', day: 'numeric', year: 'numeric' };
            
            const p50Date = new Date(today.getTime() + p50 * 7 * 24 * 60 * 60 * 1000);
            const p85Date = new Date(today.getTime() + p85 * 7 * 24 * 60 * 60 * 1000);
            const p95Date = new Date(today.getTime() + p95 * 7 * 24 * 60 * 60 * 1000);
            
            const histogram = createHistogram();
            
            document.getElementById('results').innerHTML = `
                <div class="section">
                    <div class="section-title">
                        Forecast Results
                        <span class="info-icon" onclick="showHelp('results')">i</span>
                    </div>
                    <div class="result-cards">
                        <div class="result-card likely">
                            <div class="result-label">
                                50% Confidence
                                <span class="info-icon" onclick="showHelp('confidence50')">i</span>
                            </div>
                            <div class="result-value">${Math.round(p50)} weeks</div>
                            <div class="result-date">${p50Date.toLocaleDateString('en-US', dateOptions)}</div>
                        </div>
                        <div class="result-card safe">
                            <div class="result-label">
                                85% Confidence
                                <span class="info-icon" onclick="showHelp('confidence85')">i</span>
                            </div>
                            <div class="result-value">${Math.round(p85)} weeks</div>
                            <div class="result-date">${p85Date.toLocaleDateString('en-US', dateOptions)}</div>
                        </div>
                        <div class="result-card conservative">
                            <div class="result-label">
                                95% Confidence
                                <span class="info-icon" onclick="showHelp('confidence95')">i</span>
                            </div>
                            <div class="result-value">${Math.round(p95)} weeks</div>
                            <div class="result-date">${p95Date.toLocaleDateString('en-US', dateOptions)}</div>
                        </div>
                    </div>
                </div>

                <div class="chart-container">
                    <div class="section-title">
                        Probability Distribution
                        <span class="info-icon" onclick="showHelp('distributionChart')">i</span>
                    </div>
                    <div class="chart">
                        <div class="chart-inner">
                            <div class="y-axis">
                                <div class="y-axis-label">Frequency (%)</div>
                                <div class="y-ticks">
                                    <div class="y-tick">100</div>
                                    <div class="y-tick">75</div>
                                    <div class="y-tick">50</div>
                                    <div class="y-tick">25</div>
                                    <div class="y-tick">0</div>
                                </div>
                            </div>
                            <div class="x-axis">
                                <div class="x-axis-label">Weeks to Completion</div>
                                <div class="x-ticks">
                                    ${histogram.filter((_, i) => i % 5 === 0)
                                        .map(bar => `<div class="x-tick">${bar.weeks}</div>`).join('')}
                                </div>
                            </div>
                            <div class="bars-container">
                                <div class="bars">
                                    ${histogram.map(bar => `
                                        <div class="bar" style="height: ${bar.height}%">
                                            <div class="bar-tooltip">${bar.weeks} weeks: ${bar.count} runs (${(bar.count/5).toFixed(1)}%)</div>
                                        </div>
                                    `).join('')}
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;

            // Show share button after results are displayed
            document.getElementById('shareButton').classList.remove('share-btn-hidden');
        }
        
        // Add help content for results
        helpContent.results = {
            title: "Understanding Your Results",
            content: `
                <h3>What the confidence levels mean</h3>
                <p>Each result shows a confidence level - the probability that you'll finish by that date:</p>
                <ul>
                    <li><strong>50% (Likely):</strong> You have a 50/50 chance of finishing by this date</li>
                    <li><strong>85% (Safe):</strong> You have an 85% chance of finishing by this date</li>
                    <li><strong>95% (Conservative):</strong> Almost certainly done by this date</li>
                </ul>
                
                <h3>Which estimate should I use?</h3>
                <div class="example-box">
                    <strong>For external commitments:</strong> Use 85% (Safe Estimate)<br>
                    <strong>For internal planning:</strong> Use 50% (Likely) but plan for variance<br>
                    <strong>For critical deadlines:</strong> Use 95% (Conservative)
                </div>
                
                <h3>Why these percentages?</h3>
                <p>These are industry-standard confidence levels that balance accuracy with practicality. 85% is particularly popular because it provides high confidence without excessive padding.</p>
            `
        };
        
        function createHistogram() {
            const buckets = 25;
            const min = Math.min(...results);
            const max = Math.max(...results);
            const range = max - min;
            const bucketSize = range / buckets;
            
            const histogram = [];
            let maxCount = 0;
            
            for (let i = 0; i < buckets; i++) {
                const bucketMin = min + i * bucketSize;
                const bucketMax = bucketMin + bucketSize;
                const count = results.filter(r => r >= bucketMin && r < bucketMax).length;
                maxCount = Math.max(maxCount, count);
                histogram.push({
                    weeks: Math.round(bucketMin),
                    count: count,
                    height: 0
                });
            }
            
            histogram.forEach(bar => {
                bar.height = (bar.count / maxCount) * 100;
            });
            
            return histogram;
        }
        
        // Initialize
        renderRisks();

        // TODO: Ad Viewability Tracking (uncomment after implementing AdSense ads)
        /*
        // Intersection Observer to track when ads enter viewport
        const adObserver = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting && entry.intersectionRatio >= 0.5) {
                    const adUnit = entry.target.dataset.adUnit || 'unknown';
                    trackEvent('ad_viewable', {
                        'event_category': 'ad_performance',
                        'ad_unit': adUnit,
                        'non_interaction': true
                    });
                }
            });
        }, { threshold: [0.5] });

        // Observe all ad containers after page load
        window.addEventListener('load', function() {
            document.querySelectorAll('.ad-sidebar-bottom, .ad-results-section').forEach(ad => {
                adObserver.observe(ad);
            });
        });
        */

        // Load configuration from URL on page load
        window.addEventListener('load', function() {
            // Try to load configuration from URL
            if (loadFromURL()) {
                trackEvent('load_from_url', {
                    'event_category': 'engagement',
                    'event_label': 'success'
                });

                // Automatically generate the forecast
                runSimulation();
            }
        });
    </script>

    <!-- Methodology Section -->
    <section style="max-width: 1400px; margin: 3rem auto 2rem; padding: 2rem; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 8px; color: white;">
        <h2 id="methodology" style="font-size: 1.8rem; margin-bottom: 1.5rem; text-align: center;">How Monte Carlo Estimation Works</h2>

        <article style="margin-bottom: 1.5rem;">
            <h3 style="font-size: 1.3rem; margin-bottom: 0.75rem; font-weight: 600;">The Problem with Traditional Estimation</h3>
            <p style="line-height: 1.6; opacity: 0.95;">Traditional project estimation asks you to predict a single completion date. This approach assumes everything goes according to plan - no surprises, no variability, perfect execution. Reality is messier: some weeks you complete more work, some weeks less. Scope evolves. Risks materialize. Single-point estimates are consistently wrong.</p>
        </article>

        <article style="margin-bottom: 1.5rem;">
            <h3 style="font-size: 1.3rem; margin-bottom: 0.75rem; font-weight: 600;">The Monte Carlo Solution</h3>
            <p style="line-height: 1.6; opacity: 0.95;">Monte Carlo simulation embraces uncertainty. Instead of one estimate, this tool runs your project 500 times with different combinations of variables. Each simulation randomly samples from your throughput data, scope ranges, and risk factors. The result: a probability distribution showing realistic completion dates with measurable confidence levels.</p>
        </article>

        <article style="margin-bottom: 1.5rem;">
            <h3 style="font-size: 1.3rem; margin-bottom: 0.75rem; font-weight: 600;">The Algorithm Step-by-Step</h3>
            <p style="line-height: 1.6; opacity: 0.95; margin-bottom: 0.75rem;">For each of 500 simulations, the tool:</p>
            <ol style="margin-left: 1.5rem; line-height: 1.8; opacity: 0.95;">
                <li><strong>Randomizes scope:</strong> Picks a story count between your min and max values</li>
                <li><strong>Applies split factor:</strong> Multiplies by split rate (1.0-2.0) to model stories that split during development</li>
                <li><strong>Evaluates risks:</strong> For each risk, rolls the dice - if it triggers (based on probability), adds random impact between min/max stories</li>
                <li><strong>Simulates weekly progress:</strong> Each week, randomly samples throughput from your data or triangular distribution, applies team capacity percentage, subtracts from remaining work</li>
                <li><strong>Counts weeks:</strong> Continues until all stories complete, capped at 200 weeks maximum</li>
            </ol>
            <p style="line-height: 1.6; opacity: 0.95; margin-top: 0.75rem;">After 500 trials, results are sorted to calculate percentiles: 50% (median), 85% (recommended for commitments), and 95% (high confidence).</p>
        </article>

        <article style="margin-bottom: 1.5rem;">
            <h3 style="font-size: 1.3rem; margin-bottom: 0.75rem; font-weight: 600;">Understanding Triangular Distribution</h3>
            <p style="line-height: 1.6; opacity: 0.95;">When using three-point estimates, the tool applies a triangular distribution. This means values near your "most likely" estimate occur more frequently than extreme values (pessimistic/optimistic). This creates more realistic forecasts than uniform distribution where all values are equally likely. The math: for random value U between 0 and 1, if U ≤ (mode-min)/(max-min), return min + √(U × (max-min) × (mode-min)), otherwise return max - √((1-U) × (max-min) × (max-mode)).</p>
        </article>

        <article>
            <h3 style="font-size: 1.3rem; margin-bottom: 0.75rem; font-weight: 600;">Why 500 Simulations?</h3>
            <p style="line-height: 1.6; opacity: 0.95;">500 trials provides statistically significant results while running quickly in your browser (typically under 1 second). This sample size produces stable percentile calculations - running 1000 or 10,000 simulations would yield similar results but take longer. The Central Limit Theorem ensures our probability distribution converges to the true distribution with 500 samples.</p>
        </article>
    </section>

    <!-- Acknowledgments Section -->
    <section style="max-width: 1400px; margin: 2rem auto; padding: 2rem; background: white; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); border-left: 4px solid #667eea;">
        <h2 id="acknowledgments" style="font-size: 1.8rem; margin-bottom: 1.5rem; color: #2c3e50; text-align: center;">Acknowledgments</h2>

        <article>
            <h3 style="font-size: 1.3rem; margin-bottom: 0.75rem; color: #667eea;">Inspired by Troy Magennis's Pioneering Work</h3>
            <p style="color: #495057; line-height: 1.8; margin-bottom: 1rem;">
                This tool builds upon the foundational work of <strong><a href="https://focusedobjective.com" target="_blank" rel="noopener" style="color: #667eea; text-decoration: none; border-bottom: 1px solid #667eea;">Troy Magennis</a></strong>, a pioneer in applying Monte Carlo simulation and statistical methods to agile project forecasting. Troy's work at <strong>Focused Objective</strong> has educated thousands of practitioners worldwide on data-driven forecasting techniques.
            </p>
            <p style="color: #495057; line-height: 1.8; margin-bottom: 1rem;">
                Troy's <strong>Throughput Forecaster</strong> spreadsheet and other freely-available tools demonstrated how probabilistic methods could replace traditional single-point estimates with realistic confidence intervals. His emphasis on historical data, Monte Carlo simulation, and transparent methodologies has shaped modern approaches to project forecasting in agile environments.
            </p>
            <p style="color: #495057; line-height: 1.8; margin-bottom: 1rem;">
                While this web-based tool is an independent implementation, we gratefully acknowledge Troy's intellectual contributions to the field. His educational materials and spreadsheet tools served as invaluable references during development.
            </p>
            <div style="background: #f8f9fa; border-left: 4px solid #28a745; padding: 1.25rem; margin: 1.5rem 0; border-radius: 4px;">
                <p style="margin: 0; color: #2c3e50; line-height: 1.6;"><strong>Learn More from Troy Magennis:</strong></p>
                <ul style="margin: 0.5rem 0 0 1.5rem; line-height: 1.8; color: #495057;">
                    <li><a href="https://focusedobjective.com/pages/free-spreadsheets-and-tools" target="_blank" rel="noopener" style="color: #667eea;">Free Forecasting Spreadsheets and Tools</a></li>
                    <li><a href="https://github.com/FocusedObjective/FocusedObjective.Resources" target="_blank" rel="noopener" style="color: #667eea;">FocusedObjective Resources on GitHub</a></li>
                    <li><a href="https://focusedobjective.com/courses/forecasting-using-data" target="_blank" rel="noopener" style="color: #667eea;">Forecasting Using Data Course</a></li>
                </ul>
            </div>
        </article>
    </section>

    <!-- Frequently Asked Questions Section -->
    <section style="max-width: 1400px; margin: 2rem auto 3rem; padding: 2rem; background: white; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
        <h2 style="font-size: 1.8rem; margin-bottom: 1.5rem; color: #2c3e50; text-align: center;">Frequently Asked Questions</h2>

        <article style="margin-bottom: 2rem; padding-bottom: 2rem; border-bottom: 1px solid #e1e4e8;">
            <h3 style="font-size: 1.2rem; margin-bottom: 0.75rem; color: #2c3e50;">What is Monte Carlo simulation for project estimation?</h3>
            <p style="color: #495057; line-height: 1.6;">Monte Carlo simulation is a probabilistic technique that runs hundreds of simulations using random sampling to predict project completion dates with confidence intervals. Instead of giving you a single deadline that's likely wrong, it provides a probability distribution showing realistic completion ranges based on your data.</p>
        </article>

        <article style="margin-bottom: 2rem; padding-bottom: 2rem; border-bottom: 1px solid #e1e4e8;">
            <h3 style="font-size: 1.2rem; margin-bottom: 0.75rem; color: #2c3e50;">Should I use historical data or three-point estimates?</h3>
            <p style="color: #495057; line-height: 1.6;">Use historical data if you have tracked past sprint throughput - it's significantly more accurate because it reflects actual team performance including all hidden factors. Use three-point estimates only for new teams, new types of work, or when historical data isn't available. Aim for 8-12 weeks of historical data for best results.</p>
        </article>

        <article style="margin-bottom: 2rem; padding-bottom: 2rem; border-bottom: 1px solid #e1e4e8;">
            <h3 style="font-size: 1.2rem; margin-bottom: 0.75rem; color: #2c3e50;">What confidence level should I commit to stakeholders?</h3>
            <p style="color: #495057; line-height: 1.6;">For external stakeholder commitments, use the <strong>85% confidence level</strong> - it provides high confidence without excessive padding. Use 50% only for internal planning (but expect 50% chance of delay). Reserve 95% for critical deadlines where failure has severe consequences.</p>
        </article>

        <article style="margin-bottom: 2rem; padding-bottom: 2rem; border-bottom: 1px solid #e1e4e8;">
            <h3 style="font-size: 1.2rem; margin-bottom: 0.75rem; color: #2c3e50;">How does Monte Carlo simulation work?</h3>
            <p style="color: #495057; line-height: 1.6;">The tool runs 500 trial simulations. Each trial: (1) Randomizes story count within your range, (2) Applies split factor for scope creep, (3) Evaluates each risk probabilistically, (4) Simulates weekly progress using randomized throughput until project completes. Results are sorted to calculate percentiles (50th, 85th, 95th) showing probability distribution of completion dates.</p>
        </article>

        <article style="margin-bottom: 2rem; padding-bottom: 2rem; border-bottom: 1px solid #e1e4e8;">
            <h3 style="font-size: 1.2rem; margin-bottom: 0.75rem; color: #2c3e50;">What is the split factor in project estimation?</h3>
            <p style="color: #495057; line-height: 1.6;">Split factor accounts for stories that get split into multiple smaller stories during development. A factor of 1.5 means for every 10 planned stories, you'll actually complete 15 stories worth of work. Typical values: 1.0-1.2 for well-groomed backlogs, 1.2-1.5 for normal uncertainty, 1.5-2.0 for high uncertainty or new domains.</p>
        </article>

        <article style="margin-bottom: 2rem; padding-bottom: 2rem; border-bottom: 1px solid #e1e4e8;">
            <h3 style="font-size: 1.2rem; margin-bottom: 0.75rem; color: #2c3e50;">How do I set realistic team capacity percentage?</h3>
            <p style="color: #495057; line-height: 1.6;">Team capacity accounts for time spent on non-project work. Typical values: <strong>100%</strong> for dedicated teams with no other responsibilities, <strong>70-80%</strong> for primary project with some maintenance, <strong>50-60%</strong> for teams with significant other responsibilities. Track actual time for one week if unsure - you'll likely find attention is more fragmented than expected.</p>
        </article>

        <article style="margin-bottom: 2rem; padding-bottom: 2rem; border-bottom: 1px solid #e1e4e8;">
            <h3 style="font-size: 1.2rem; margin-bottom: 0.75rem; color: #2c3e50;">Why is Monte Carlo better than traditional estimation?</h3>
            <p style="color: #495057; line-height: 1.6;">Traditional estimation assumes everything goes to plan - it produces single-point estimates that are consistently wrong. Monte Carlo acknowledges reality: throughput varies week to week, scope changes, risks materialize. By modeling these variables probabilistically across hundreds of scenarios, you get realistic ranges with measurable confidence levels instead of false precision.</p>
        </article>

        <article style="margin-bottom: 2rem; padding-bottom: 2rem; border-bottom: 1px solid #e1e4e8;">
            <h3 style="font-size: 1.2rem; margin-bottom: 0.75rem; color: #2c3e50;">Can I use this for Scrum or Kanban teams?</h3>
            <p style="color: #495057; line-height: 1.6;">Yes, Monte Carlo estimation works for any agile methodology. For Scrum teams, use story points or story counts completed per sprint. For Kanban teams, use throughput (items completed per week) from your cumulative flow diagram. The key is consistent measurement - whatever units you track, use those consistently.</p>
        </article>

        <article style="margin-bottom: 2rem; padding-bottom: 2rem; border-bottom: 1px solid #e1e4e8;">
            <h3 style="font-size: 1.2rem; margin-bottom: 0.75rem; color: #2c3e50;">What types of risks should I add to the simulation?</h3>
            <p style="color: #495057; line-height: 1.6;">Include 2-5 meaningful risks that might add work: legacy code refactoring, regulatory requirements, integration issues, additional platform support. Each risk needs probability (0-100%) and impact range (min/max stories added). Don't use 100% probability - if something is certain, add it to your scope range instead of modeling as a risk.</p>
        </article>

        <article style="margin-bottom: 2rem; padding-bottom: 2rem; border-bottom: 1px solid #e1e4e8;">
            <h3 style="font-size: 1.2rem; margin-bottom: 0.75rem; color: #2c3e50;">How accurate is Monte Carlo project estimation?</h3>
            <p style="color: #495057; line-height: 1.6;">Monte Carlo simulations typically provide 85-95% accuracy when based on quality historical data, significantly outperforming traditional estimation methods. Accuracy depends on input data quality - using actual past throughput yields much better results than estimates. The more historical data you have, the more accurate your forecasts become.</p>
        </article>

        <article style="margin-bottom: 0;">
            <h3 style="font-size: 1.2rem; margin-bottom: 0.75rem; color: #2c3e50;">Is this Monte Carlo estimation tool free?</h3>
            <p style="color: #495057; line-height: 1.6;">Yes, this tool is <strong>completely free</strong> to use with no registration or account required. All calculations run entirely in your browser - your project data never leaves your device. We can't see or access any of your project information, story counts, or throughput data.</p>
        </article>
    </section>
    </main>

    <footer>
        <p>&copy; 2025 Monte Carlo Estimation Tool | <a href="#acknowledgments">Acknowledgments</a> | <a href="ai-citation.html" rel="noopener">For AI Assistants</a> | <a href="privacy.html" rel="noopener">Privacy Policy</a></p>
    </footer>
</body>
</html>